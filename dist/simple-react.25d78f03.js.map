{"version":3,"sources":["src/SmpReact/main_methods/createElement.js","src/SmpReact/utils/dom.js","src/SmpReact/dom_methods/render.js","src/SmpReact/dom_methods/diff.js","src/SmpReact/main_methods/update.js","src/SmpReact/main_methods/Component.js","src/SmpReact/SmpReact.js","src/SmpReact/SmpReactDom.js","src/components/Header/Header.jsx","src/components/Footer/Footer.jsx","src/components/Counter/Counter.jsx","App.jsx","index.jsx"],"names":["createVNode","type","props","ref","key","children","domElm","text","createElement","tag","elementName","data","attributes","length","i","child","includes","undefined","String","dom","vnode","document","createTextNode","setTextContent","content","nodeValue","getParentNode","elm","parentNode","appendChild","parent","removeChild","getNextSibling","nextSibling","insertBefore","newNode","refNode","insertAfter","lastChild","addClass","className","classList","add","bindEvent","fn","addEventListener","removeEvent","removeEventListener","setAttr","value","setAttribute","removeAttr","removeAttribute","createDomElement","Array","isArray","renderComponent","setDomProps","keys","Object","startsWith","eventName","substring","toLowerCase","console","log","compVNode","Comp","instance","prototype","render","__nextProps","__nextState","state","__createVNode","__component","component","parentDom","diff","oldVNode","newVNode","isSameVNode","diffComponent","diffVNode","replaceVNode","oldCompVNode","newCompVNode","nextProps","__dirty","oldChild","oldText","oldProps","newChild","newText","newProps","diffProps","hasOldChild","Boolean","hasNewChild","diffChildren","addVNodes","removeVNodes","oldDomElm","newDomElm","oldV","newV","before","start","end","newDom","parentElm","oldStartIdx","newStartIdx","oldEndIdx","newEndIdx","oldStartVNode","oldEndVNode","newStartVNode","newEndVNode","oldKeyToIdx","idxInOld","elmToMove","createKeyList","map","defer","Promise","resolve","then","updateQueue","enqueueRender","updater","push","flushRenderQueue","sort","curUpdater","pop","__update","flushCallback","callbacks","__setStateCallbacks","cbk","shift","call","Component","__prevProps","__prevState","__vnode","operater","callback","SmpReact","SmpReactDom","Footer","imgsrc","Counter","disabled","n","minus","mult","clear","setInterval","clearInterval","App","interval","flag","calc","setState","Error","that","window","alert","getElementById"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACO,SAASA,WAAT,CAAqBC,IAArB,EAA2BC,KAA3B,EAAkCC,GAAlC,EAAuCC,GAAvC,EAA4CC,QAA5C,EAAsDC,MAAtD,EAA8DC,IAA9D,EAAoE;AACzE,SAAO;AACLN,IAAAA,IAAI,EAAJA,IADK;AACC;AACNC,IAAAA,KAAK,EAALA,KAFK;AAEG;AACRG,IAAAA,QAAQ,EAARA,QAHK;AAGK;AACVF,IAAAA,GAAG,EAAHA,GAJK;AAIC;AACNC,IAAAA,GAAG,EAAHA,GALK;AAKC;AACNE,IAAAA,MAAM,EAANA,MANK;AAMI;AACTC,IAAAA,IAAI,EAAJA,IAPK,CAOC;;AAPD,GAAP;AASD;;AAEc,SAASC,aAAT,CAAuBC,GAAvB,EAA4B;AAAA,MACrBR,IADqB,GACeQ,GADf,CAClCC,WADkC;AAAA,MACHC,IADG,GACeF,GADf,CACfG,UADe;AAAA,MACGP,QADH,GACeI,GADf,CACGJ,QADH;;AAAA,MAElCD,GAFkC,GAEZO,IAFY,CAElCP,GAFkC;AAAA,MAE7BD,GAF6B,GAEZQ,IAFY,CAE7BR,GAF6B;AAAA,MAErBD,KAFqB,4BAEZS,IAFY,mBAIzC;;;AACA,MAAIN,QAAQ,IAAIA,QAAQ,CAACQ,MAAzB,EAAiC;AAC/B,QAAMA,MAAM,GAAGR,QAAQ,CAACQ,MAAxB;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,MAApB,EAA4BC,CAAC,EAA7B,EAAiC;AAC/B,UAAMC,KAAK,GAAGV,QAAQ,CAACS,CAAD,CAAtB,CAD+B,CACH;;AAC5B,UAAI,CAAC,QAAD,EAAW,QAAX,EAAqBE,QAArB,SAAqCD,KAArC,EAAJ,EAAiD;AAC/C;AACAV,QAAAA,QAAQ,CAACS,CAAD,CAAR,GAAcd,WAAW,CACvBiB,SADuB,EAEvB,EAFuB,EAGvBA,SAHuB,EAIvBA,SAJuB,EAKvBA,SALuB,EAMvBA,SANuB,EAOvBC,MAAM,CAACb,QAAQ,CAACS,CAAD,CAAT,CAPiB,CAAzB;AASD;AACF;AACF;;AACD,SAAOd,WAAW,CAACC,IAAD,EAAOC,KAAP,EAAcC,GAAd,EAAmBC,GAAnB,EAAwBC,QAAxB,EAAkCY,SAAlC,EAA6CA,SAA7C,CAAlB;AACD;;;;;;;;;;;ACrCD;AACA;AACA;AAEA,IAAME,GAAG,GAAG;AACV;AACAX,EAAAA,aAFU,yBAEIY,KAFJ,EAEW;AACnB,WAAOC,QAAQ,CAACb,aAAT,CAAuBY,KAAK,CAACnB,IAA7B,CAAP;AACD,GAJS;AAMV;AACAqB,EAAAA,cAPU,0BAOKf,IAPL,EAOW;AACnB,WAAOc,QAAQ,CAACC,cAAT,CAAwBf,IAAxB,CAAP;AACD,GATS;AAWV;AACAgB,EAAAA,cAZU,0BAYKjB,MAZL,EAYakB,OAZb,EAYsB;AAC9B,QAAIlB,MAAM,IAAI,CAAC,QAAD,EAAW,QAAX,EAAqBU,QAArB,SAAqCQ,OAArC,EAAd,EAA6D;AAC3DlB,MAAAA,MAAM,CAACmB,SAAP,GAAmBD,OAAnB;AACD;AACF,GAhBS;AAkBV;AACAE,EAAAA,aAnBU,yBAmBIC,GAnBJ,EAmBS;AACjB,WAAOA,GAAG,IAAIA,GAAG,CAACC,UAAlB;AACD,GArBS;AAuBV;AACAC,EAAAA,WAxBU,uBAwBEC,MAxBF,EAwBUf,KAxBV,EAwBiB;AACzBe,IAAAA,MAAM,CAACD,WAAP,CAAmBd,KAAnB;AACD,GA1BS;AA4BV;AACAgB,EAAAA,WA7BU,uBA6BED,MA7BF,EA6BUf,KA7BV,EA6BiB;AACzB,QAAIA,KAAK,IAAIe,MAAT,IAAmBf,KAAK,CAACa,UAA7B,EAAyC;AACvCE,MAAAA,MAAM,CAACC,WAAP,CAAmBhB,KAAnB;AACD;AACF,GAjCS;AAmCV;AACAiB,EAAAA,cApCU,0BAoCK1B,MApCL,EAoCa;AACrB,WAAOA,MAAM,CAAC2B,WAAP,KAAuB,IAAvB,GAA8B,KAA9B,GAAsC3B,MAAM,CAAC2B,WAApD;AACD,GAtCS;AAwCV;AACAC,EAAAA,YAzCU,wBAyCGJ,MAzCH,EAyCWK,OAzCX,EAyCoBC,OAzCpB,EAyC6B;AACrC,QAAIA,OAAJ,EAAa;AACXN,MAAAA,MAAM,CAACI,YAAP,CAAoBC,OAApB,EAA6BC,OAA7B;AACD,KAFD,MAEO;AACLjB,MAAAA,GAAG,CAACU,WAAJ,CAAgBC,MAAhB,EAAwBK,OAAxB;AACD;AACF,GA/CS;AAiDV;AACAE,EAAAA,WAlDU,uBAkDEF,OAlDF,EAkDWC,OAlDX,EAkDoB;AAC5B,QAAMN,MAAM,GAAGM,OAAO,CAACR,UAAvB;;AACA,QAAIE,MAAM,CAACQ,SAAP,KAAqBF,OAAzB,EAAkC;AAChCN,MAAAA,MAAM,CAACD,WAAP,CAAmBM,OAAnB;AACD,KAFD,MAEO;AACLL,MAAAA,MAAM,CAACI,YAAP,CAAoBC,OAApB,EAA6BC,OAAO,CAACH,WAArC;AACD;AACF,GAzDS;AA2DV;AACAM,EAAAA,QA5DU,oBA4DDjC,MA5DC,EA4DOkC,SA5DP,EA4DkB;AAC1BlC,IAAAA,MAAM,CAACmC,SAAP,CAAiBC,GAAjB,CAAqBF,SAArB;AACD,GA9DS;AAgEV;AACAG,EAAAA,SAjEU,qBAiEArC,MAjEA,EAiEQL,IAjER,EAiEc2C,EAjEd,EAiEkB;AAC1BtC,IAAAA,MAAM,CAACuC,gBAAP,CAAwB5C,IAAxB,EAA8B2C,EAA9B;AACD,GAnES;AAqEV;AACAE,EAAAA,WAtEU,uBAsEExC,MAtEF,EAsEUL,IAtEV,EAsEgB2C,EAtEhB,EAsEoB;AAC5BtC,IAAAA,MAAM,CAACyC,mBAAP,CAA2B9C,IAA3B,EAAiC2C,EAAjC;AACD,GAxES;AA0EV;AACAI,EAAAA,OA3EU,mBA2EF1C,MA3EE,EA2EMF,GA3EN,EA2EW6C,KA3EX,EA2EkB;AAC1B3C,IAAAA,MAAM,CAAC4C,YAAP,CAAoB9C,GAApB,EAAyB6C,KAAzB;AACD,GA7ES;AA+EV;AACAE,EAAAA,UAhFU,sBAgFC7C,MAhFD,EAgFSF,GAhFT,EAgFc;AACtBE,IAAAA,MAAM,CAAC8C,eAAP,CAAuBhD,GAAvB;AACD;AAlFS,CAAZ;eAqFee;;;;;;;;;;;;;ACzFf;;AACA;;;;;;AAEA;AACO,SAASkC,gBAAT,CAA0BjC,KAA1B,EAAiC;AACtC;AACA;AAEA,MAAIkC,KAAK,CAACC,OAAN,CAAcnC,KAAd,CAAJ,EAA0B;AACxB;AACAA,IAAAA,KAAK,GAAG,gCAAY,KAAZ,EAAmBH,SAAnB,EAA8BA,SAA9B,EAAyCA,SAAzC,EAAoDG,KAApD,EAA2DH,SAA3D,CAAR;AACD;;AACD,MAAI,OAAOG,KAAK,CAACnB,IAAb,KAAsB,UAA1B,EAAsC;AACpC;AACAmB,IAAAA,KAAK,GAAGoC,eAAe,CAACpC,KAAD,CAAvB;AACD;;AAXqC,eAYAA,KAZA;AAAA,MAY/Bf,QAZ+B,UAY/BA,QAZ+B;AAAA,MAYrBJ,IAZqB,UAYrBA,IAZqB;AAAA,MAYfM,IAZe,UAYfA,IAZe;AAAA,MAYTL,KAZS,UAYTA,KAZS;;AActC,MAAID,IAAI,IAAI,OAAOA,IAAP,KAAgB,QAA5B,EAAsC;AACpC;AACAmB,IAAAA,KAAK,CAACd,MAAN,GAAea,aAAIX,aAAJ,CAAkBY,KAAlB,CAAf,CAFoC,CAEI;;AACxC,QAAIkC,KAAK,CAACC,OAAN,CAAclD,QAAd,CAAJ,EAA6B;AAC3B;AACA,WAAK,IAAIS,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGT,QAAQ,CAACQ,MAA7B,EAAqCC,CAAC,EAAtC,EAA0C;AACxCK,qBAAIU,WAAJ,CAAgBT,KAAK,CAACd,MAAtB,EAA8B+C,gBAAgB,CAAChD,QAAQ,CAACS,CAAD,CAAT,CAA9C;AACD;AACF;AACF,GATD,MASO,IAAI,CAACb,IAAI,KAAKgB,SAAT,IAAsBhB,IAAI,KAAK,IAAhC,KAAyCM,IAA7C,EAAmD;AACxD;AACAa,IAAAA,KAAK,CAACd,MAAN,GAAea,aAAIG,cAAJ,CAAmBf,IAAnB,CAAf;AACD;;AAED,MAAIa,KAAK,CAACd,MAAV,EAAkB;AAAC;AACjBmD,IAAAA,WAAW,CAACrC,KAAK,CAACd,MAAP,EAAeJ,KAAf,CAAX;AACA,WAAOkB,KAAK,CAACd,MAAb;AACD,GAHD,MAGO;AAAG;AACR,WAAO+C,gBAAgB,CAACjC,KAAD,CAAvB;AACD;AACF,EAED;;;AACO,SAASqC,WAAT,CAAqBnD,MAArB,EAA6BJ,KAA7B,EAAoC;AACzC,MAAII,MAAM,IAAI,QAAOJ,KAAP,MAAiB,QAA/B,EAAyC;AACvC,QAAMwD,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYxD,KAAZ,CAAb;;AACA,SAAK,IAAIY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4C,IAAI,CAAC7C,MAAzB,EAAiCC,CAAC,EAAlC,EAAsC;AAEpC,UAAMV,GAAG,GAAGsD,IAAI,CAAC5C,CAAD,CAAhB;AACA,UAAMmC,KAAK,GAAG/C,KAAK,CAACE,GAAD,CAAnB;;AAEA,UAAIA,GAAG,CAACwD,UAAJ,CAAe,IAAf,CAAJ,EAA0B;AACxB;AACA,YAAI,OAAOX,KAAP,KAAiB,UAArB,EAAiC;AAC/B,cAAMY,SAAS,GAAGzD,GAAG,CAAC0D,SAAJ,CAAc,CAAd,EAAiBC,WAAjB,EAAlB,CAD+B,CACoB;;AACnD5C,uBAAIwB,SAAJ,CAAcrC,MAAd,EAAsBuD,SAAtB,EAAiCZ,KAAjC;AACD,SAHD,MAGO;AACLe,UAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACD;AACF,OARD,MAQO,IAAI7D,GAAG,KAAK,WAAZ,EAAyB;AAC9B;AACAe,qBAAIoB,QAAJ,CAAajC,MAAb,EAAqB2C,KAArB;AACD,OAHM,MAGA;AACL;AACA9B,qBAAI6B,OAAJ,CAAY1C,MAAZ,EAAoBF,GAApB,EAAyB6C,KAAzB;AACD;AAEF;AACF;AACF;AAED;;;AACO,SAASO,eAAT,CAAyBU,SAAzB,EAAoC;AAAA,MAC5BC,IAD4B,GACbD,SADa,CAClCjE,IADkC;AAAA,MACtBC,KADsB,GACbgE,SADa,CACtBhE,KADsB,EACD;;AACxC,MAAIkE,QAAQ,GAAGF,SAAS,CAACE,QAAzB,CAFyC,CAGzC;;AACA,MAAI,CAACA,QAAL,EAAe;AACb;AACA;AACA,QAAID,IAAI,CAACE,SAAL,IAAkBF,IAAI,CAACE,SAAL,CAAeC,MAArC,EAA6C;AAC3CF,MAAAA,QAAQ,GAAG,IAAID,IAAJ,CAASjE,KAAT,CAAX;AACD,KALY,CAOb;;;AACAkE,IAAAA,QAAQ,CAACG,WAAT,GAAuBrE,KAAvB;AACAkE,IAAAA,QAAQ,CAACI,WAAT,GAAuBJ,QAAQ,CAACK,KAAhC;AACD,GAdwC,CAgBzC;;;AACA,MAAMrD,KAAK,GAAGgD,QAAQ,CAACM,aAAT,EAAd,CAjByC,CAmBzC;;;AACAN,EAAAA,QAAQ,CAACO,WAAT,GAAuBT,SAAvB,CApByC,CAoBP;;AAClCA,EAAAA,SAAS,CAACE,QAAV,GAAqBA,QAArB,CArByC,CAqBT;;AAChCF,EAAAA,SAAS,CAAC9C,KAAV,GAAkBA,KAAlB,CAtByC,CAsBb;;AAC5BA,EAAAA,KAAK,CAACwD,SAAN,GAAkBV,SAAlB,CAvByC,CAuBX;;AAE9B,SAAO9C,KAAP;AACD,EAED;;;AACe,SAASkD,MAAT,CAAgBlD,KAAhB,EAAuByD,SAAvB,EAAkC;AAC/C,MAAMvE,MAAM,GAAG+C,gBAAgB,CAACjC,KAAD,CAA/B,CAD+C,CACP;;AACxCD,eAAIU,WAAJ,CAAgBgD,SAAhB,EAA2BvE,MAA3B,EAF+C,CAEV;;;AACrC,SAAOA,MAAP;AACD;;;;;;;;;ACvGD;;AACA;;;;;;AAEA;AACO,SAASwE,IAAT,CAAcC,QAAd,EAAwBC,QAAxB,EAAkC;AACvC,MAAIC,WAAW,CAACF,QAAD,EAAWC,QAAX,CAAf,EAAqC;AACnC,QAAI,OAAOD,QAAQ,CAAC9E,IAAhB,KAAyB,UAA7B,EAAyC;AACvC;AACAiF,MAAAA,aAAa,CAACH,QAAD,EAAWC,QAAX,CAAb;AACD,KAHD,MAGO;AACL;AACAG,MAAAA,SAAS,CAACJ,QAAD,EAAWC,QAAX,CAAT;AACD;AACF,GARD,MAQO;AACLhB,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACAmB,IAAAA,YAAY,CAACL,QAAD,EAAWC,QAAX,CAAZ;AACD;AACF,EAED;;;AACA,SAASE,aAAT,CAAuBG,YAAvB,EAAqCC,YAArC,EAAmD;AAAA,MAC1ClB,QAD0C,GACRiB,YADQ,CAC1CjB,QAD0C;AAAA,MACzBW,QADyB,GACRM,YADQ,CAChCjE,KADgC;AAAA,MACfO,GADe,GACR0D,YADQ,CACf1D,GADe;AAAA,MAEnC4D,SAFmC,GAEtBD,YAFsB,CAE1CpF,KAF0C;;AAIjD,MAAIkE,QAAQ,IAAIW,QAAhB,EAA0B;AACxBX,IAAAA,QAAQ,CAACoB,OAAT,GAAmB,KAAnB,CADwB,CAGxB;;AACApB,IAAAA,QAAQ,CAACG,WAAT,GAAuBgB,SAAvB;AACA,QAAI,CAACnB,QAAQ,CAACI,WAAd,EAA2BJ,QAAQ,CAACI,WAAT,GAAuBJ,QAAQ,CAACK,KAAhC,CALH,CAOxB;;AACAa,IAAAA,YAAY,CAAClB,QAAb,GAAwBA,QAAxB;AACAkB,IAAAA,YAAY,CAAC3D,GAAb,GAAmBA,GAAnB,CATwB,CAWxB;AACA;;AACA,QAAMqD,QAAQ,GAAG,6BAAgBM,YAAhB,CAAjB,CAbwB,CAexB;;AACAR,IAAAA,IAAI,CAACC,QAAD,EAAWC,QAAX,CAAJ;AACD;AACF,EAED;;;AACA,SAASG,SAAT,CAAmBJ,QAAnB,EAA6BC,QAA7B,EAAuC;AAAA,MAE9B1E,MAF8B,GAEgCyE,QAFhC,CAE9BzE,MAF8B;AAAA,MAEZmF,QAFY,GAEgCV,QAFhC,CAEtB1E,QAFsB;AAAA,MAEIqF,OAFJ,GAEgCX,QAFhC,CAEFxE,IAFE;AAAA,MAEoBoF,QAFpB,GAEgCZ,QAFhC,CAEa7E,KAFb;AAAA,MAGpB0F,QAHoB,GAGwBZ,QAHxB,CAG9B3E,QAH8B;AAAA,MAGJwF,OAHI,GAGwBb,QAHxB,CAGVzE,IAHU;AAAA,MAGYuF,QAHZ,GAGwBd,QAHxB,CAGK9E,KAHL;AAKrC,MAAI6E,QAAQ,KAAKC,QAAb,IAAyB,CAAC1E,MAA9B,EAAsC,OALD,CAOrC;;AACA0E,EAAAA,QAAQ,CAAC1E,MAAT,GAAkBA,MAAlB,CARqC,CAUrC;;AACAyF,EAAAA,SAAS,CAACzF,MAAD,EAASqF,QAAT,EAAmBG,QAAnB,CAAT;AAEA,MAAME,WAAW,GAAGC,OAAO,CAACR,QAAQ,IAAIA,QAAQ,CAAC5E,MAAtB,CAA3B;AACA,MAAMqF,WAAW,GAAGD,OAAO,CAACL,QAAQ,IAAIA,QAAQ,CAAC/E,MAAtB,CAA3B;;AAEA,MAAIgF,OAAO,KAAK5E,SAAhB,EAA2B;AACzB;AACAE,iBAAII,cAAJ,CAAmBjB,MAAnB,EAA2BuF,OAA3B;AACD,GAHD,MAGO;AACL;AACA,QAAIG,WAAW,IAAIE,WAAnB,EAAgC;AAC9B;AACA,UAAIT,QAAQ,KAAKG,QAAjB,EAA2BO,YAAY,CAAC7F,MAAD,EAASmF,QAAT,EAAmBG,QAAnB,CAAZ;AAC5B,KAHD,MAGO,IAAIM,WAAJ,EAAiB;AACtB;AACAE,MAAAA,SAAS,CAAC9F,MAAD,EAAS,IAAT,EAAesF,QAAf,EAAyB,CAAzB,EAA4BA,QAAQ,CAAC/E,MAAT,GAAkB,CAA9C,CAAT;AACD,KAHM,MAGA,IAAImF,WAAJ,EAAiB;AACtB;AACAK,MAAAA,YAAY,CAAC/F,MAAD,EAASmF,QAAT,EAAmB,CAAnB,EAAsBA,QAAQ,CAAC5E,MAAT,GAAkB,CAAxC,CAAZ;AACD,KAXI,CAYL;AACA;AACA;AACA;AACA;AACA;;AACD;AACF,EAED;;;AACA,SAASuE,YAAT,CAAsBL,QAAtB,EAAgCC,QAAhC,EAA0C;AAAA,MAEzBsB,SAFyB,GAEZvB,QAFY,CAEjCzE,MAFiC;;AAGxC,MAAMuE,SAAS,GAAG1D,aAAIO,aAAJ,CAAkB4E,SAAlB,CAAlB,CAHwC,CAKxC;;;AACAnF,eAAIY,WAAJ,CAAgB8C,SAAhB,EAA2ByB,SAA3B,EANwC,CAOxC;;;AACA,MAAMC,SAAS,GAAG,8BAAiBvB,QAAjB,CAAlB;;AACA7D,eAAIU,WAAJ,CAAgBgD,SAAhB,EAA2B0B,SAA3B;AAED;;AAED,SAASR,SAAT,CAAmBzF,MAAnB,EAA2BqF,QAA3B,EAAqCG,QAArC,EAA+C;AAC7C,MAAIH,QAAQ,KAAKG,QAAb,IAAyB,CAACxF,MAA9B,EAAsC;;AACtC,MAAI,QAAOqF,QAAP,MAAoB,QAApB,IAAgC,QAAOG,QAAP,MAAoB,QAAxD,EAAkE;AAChE,QAAIpC,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYiC,QAAZ,CAAX,CADgE,CAGhE;;AACA,SAAK,IAAI7E,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4C,IAAI,CAAC7C,MAAzB,EAAiCC,CAAC,EAAlC,EAAsC;AACpC,UAAMV,GAAG,GAAGsD,IAAI,CAAC5C,CAAD,CAAhB;AACA,UAAM0F,IAAI,GAAGb,QAAQ,CAACvF,GAAD,CAArB;AAAA,UAA4BqG,IAAI,GAAGX,QAAQ,CAAC1F,GAAD,CAA3C;AAEA,UAAIA,GAAG,KAAK,WAAR,IAAuBoG,IAAI,KAAK,KAApC,EAA2CxC,OAAO,CAACC,GAAR,CAAY7D,GAAZ,EAAiBoG,IAAjB,EAAuBC,IAAvB;;AAE3C,UAAIrG,GAAG,CAACwD,UAAJ,CAAe,IAAf,CAAJ,EAA0B;AACxB;AACA,YAAI,OAAO4C,IAAP,KAAgB,UAAhB,IAA8BA,IAAI,KAAKC,IAA3C,EAAiD;AAC/C;AACA,cAAM5C,SAAS,GAAGzD,GAAG,CAAC0D,SAAJ,CAAc,CAAd,EAAiBC,WAAjB,EAAlB;;AACA5C,uBAAI2B,WAAJ,CAAgBxC,MAAhB,EAAwBuD,SAAxB,EAAmC2C,IAAnC;AACD;AACF,OAPD,MAOO;AACL;AACA,YAAIC,IAAI,KAAKxF,SAAT,IAAuBb,GAAG,KAAK,WAAR,KAAwBqG,IAAI,KAAK,KAAT,IAAkBA,IAAI,KAAK,IAAnD,CAA3B,EAAsF;AACpF;AACA;AACAtF,uBAAIgC,UAAJ,CAAe7C,MAAf,EAAuBF,GAAG,KAAK,WAAR,GAAsB,OAAtB,GAAgCA,GAAvD;AACD;AACF;AACF,KAzB+D,CA2BhE;;;AACA,6BAAYE,MAAZ,EAAoBwF,QAApB;AACD;AACF,EAED;;;AACA,SAASM,SAAT,CAAmB9F,MAAnB,EAA2BoG,MAA3B,EAAmCrG,QAAnC,EAA6CsG,KAA7C,EAAoDC,GAApD,EAAyD;AACvD,OAAK,IAAI9F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8F,GAAG,GAAGD,KAA1B,EAAiC7F,CAAC,EAAlC,EAAsC;AACpC,QAAI+F,MAAM,GAAGxG,QAAQ,CAACS,CAAD,CAAR,CAAYR,MAAZ,IAAsB,8BAAiBD,QAAQ,CAACS,CAAD,CAAzB,CAAnC;;AACAK,iBAAIkB,WAAJ,CAAgBwE,MAAhB,EAAwBH,MAAxB;;AACAA,IAAAA,MAAM,GAAGG,MAAT;AACD;AACF,EAED;;;AACA,SAASR,YAAT,CAAsB/F,MAAtB,EAA8BD,QAA9B,EAAwCsG,KAAxC,EAA+CC,GAA/C,EAAoD;AAClD,OAAK,IAAI9F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8F,GAAG,GAAGD,KAA1B,EAAiC7F,CAAC,EAAlC,EAAsC;AACpCK,iBAAIY,WAAJ,CAAgBzB,MAAhB,EAAwBD,QAAQ,CAACS,CAAD,CAAhC;AACD;AACF,EAED;;;AACA,SAASqF,YAAT,CAAsBW,SAAtB,EAAiCrB,QAAjC,EAA2CG,QAA3C,EAAqD;AAEnD;AACF;AACA;AACA;AAEI;AACF,MAAImB,WAAW,GAAG,CAAlB;AAAA,MAAqBC,WAAW,GAAG,CAAnC;AACA,MAAIC,SAAS,GAAGxB,QAAQ,CAAC5E,MAAT,GAAkB,CAAlC;AAAA,MAAqCqG,SAAS,GAAGtB,QAAQ,CAAC/E,MAAT,GAAkB,CAAnE,CATmD,CAWnD;;AACA,MAAIsG,aAAa,GAAG1B,QAAQ,CAAC,CAAD,CAA5B;AAAA,MAAiC2B,WAAW,GAAG3B,QAAQ,CAACwB,SAAD,CAAvD;AACA,MAAII,aAAa,GAAGzB,QAAQ,CAAC,CAAD,CAA5B;AAAA,MAAiC0B,WAAW,GAAG1B,QAAQ,CAACsB,SAAD,CAAvD;AAEA,MAAIK,WAAJ,EAAiBC,QAAjB,EAA2BC,SAA3B,EAAsCf,MAAtC;AAEA;AACF;AACA;AACA;AACA;;AACE,SAAOK,WAAW,IAAIE,SAAf,IAA4BD,WAAW,IAAIE,SAAlD,EAA6D;AAC3D;AACJ;AACA;AACA;AACI,QAAIC,aAAa,IAAI,IAArB,EAA2BA,aAAa,GAAG1B,QAAQ,CAAC,EAAEsB,WAAH,CAAxB,CAA3B,KACK,IAAIK,WAAW,IAAI,IAAnB,EAAyBA,WAAW,GAAG3B,QAAQ,CAAC,EAAEwB,SAAH,CAAtB,CAAzB,KACA,IAAII,aAAa,IAAI,IAArB,EAA2BA,aAAa,GAAGzB,QAAQ,CAAC,EAAEoB,WAAH,CAAxB,CAA3B,KACA,IAAIM,WAAW,IAAI,IAAnB,EAAyBA,WAAW,GAAG1B,QAAQ,CAAC,EAAEsB,SAAH,CAAtB,CAAzB,KACA,IAAIjC,WAAW,CAACkC,aAAD,EAAgBE,aAAhB,CAAf,EAA+C;AAClD;AACN;AACA;AACA;AACA;AACMvC,MAAAA,IAAI,CAACqC,aAAD,EAAgBE,aAAhB,CAAJ;AAEAF,MAAAA,aAAa,GAAG1B,QAAQ,CAAC,EAAEsB,WAAH,CAAxB;AACAM,MAAAA,aAAa,GAAGzB,QAAQ,CAAC,EAAEoB,WAAH,CAAxB;AACD,KAVI,MAUE,IAAI/B,WAAW,CAACmC,WAAD,EAAcE,WAAd,CAAf,EAA2C;AAEhDxC,MAAAA,IAAI,CAACsC,WAAD,EAAcE,WAAd,CAAJ;AAEAF,MAAAA,WAAW,GAAG3B,QAAQ,CAAC,EAAEwB,SAAH,CAAtB;AACAK,MAAAA,WAAW,GAAG1B,QAAQ,CAAC,EAAEsB,SAAH,CAAtB;AACD,KANM,MAMA,IAAIjC,WAAW,CAACkC,aAAD,EAAgBG,WAAhB,CAAf,EAA6C;AAElDnG,mBAAIe,YAAJ,CAAiB4E,SAAjB,EAA4BK,aAAa,CAAC7G,MAA1C,EAAkDa,aAAIa,cAAJ,CAAmBoF,WAAW,CAAC9G,MAA/B,CAAlD;;AACAwE,MAAAA,IAAI,CAACqC,aAAD,EAAgBG,WAAhB,CAAJ;AAEAH,MAAAA,aAAa,GAAG1B,QAAQ,CAAC,EAAEsB,WAAH,CAAxB;AACAO,MAAAA,WAAW,GAAG1B,QAAQ,CAAC,EAAEsB,SAAH,CAAtB;AACD,KAPM,MAOA,IAAIjC,WAAW,CAACmC,WAAD,EAAcC,aAAd,CAAf,EAA6C;AAElDlG,mBAAIe,YAAJ,CAAiBJ,MAAjB,EAAyBsF,WAAW,CAAC9G,MAArC,EAA6C6G,aAAa,CAAC7G,MAA3D;;AACAwE,MAAAA,IAAI,CAACsC,WAAD,EAAcC,aAAd,CAAJ;AAEAD,MAAAA,WAAW,GAAG3B,QAAQ,CAAC,EAAEwB,SAAH,CAAtB;AACAI,MAAAA,aAAa,GAAGzB,QAAQ,CAAC,EAAEoB,WAAH,CAAxB;AACD,KAPM,MAOA;AACL;AACN;AACA;AACA;AACM;AACA,UAAI,CAACO,WAAL,EAAkBA,WAAW,GAAGG,aAAa,CAACjC,QAAD,EAAWsB,WAAX,EAAwBE,SAAxB,CAA3B,CANb,CAQL;;AACAO,MAAAA,QAAQ,GAAGD,WAAW,CAACF,aAAa,CAACjH,GAAd,IAAqB,EAAtB,CAAtB;;AACA,UAAI,CAACoH,QAAL,EAAe;AACb;AACR;AACA;AACA;AACQrG,qBAAIe,YAAJ,CAAiB4E,SAAjB,EAA4B,8BAAiBO,aAAjB,CAA5B,EAA6DF,aAAa,CAAC7G,MAA3E;;AACA+G,QAAAA,aAAa,GAAGzB,QAAQ,CAAC,EAAEoB,WAAH,CAAxB;AACD,OAPD,MAOO;AACL;AACR;AACA;AACA;AACQS,QAAAA,SAAS,GAAGhC,QAAQ,CAAC+B,QAAD,CAApB;;AACA,YAAIvC,WAAW,CAACwC,SAAD,EAAYJ,aAAZ,CAAf,EAA2C;AACzC;AACV;AACA;AACA;AACUlG,uBAAIe,YAAJ,CAAiB4E,SAAjB,EAA4BW,SAAS,CAACnH,MAAtC,EAA8C6G,aAAa,CAAC7G,MAA5D;;AACAwE,UAAAA,IAAI,CAAC2C,SAAD,EAAYJ,aAAZ,CAAJ,CANyC,CAQzC;AACA;;AACA5B,UAAAA,QAAQ,CAAC+B,QAAD,CAAR,GAAqBvG,SAArB;AACD,SAXD,MAWO;AACL;AACV;AACA;AACA;AACUE,uBAAIe,YAAJ,CAAiB4E,SAAjB,EAA4B,8BAAiBO,aAAjB,CAA5B,EAA6DF,aAAa,CAAC7G,MAA3E;AACD;;AACD+G,QAAAA,aAAa,GAAGzB,QAAQ,CAAC,EAAEoB,WAAH,CAAxB;AACD;AACF;AACF;AAED;AACF;AACA;AACA;AACA;;;AACE,MAAID,WAAW,IAAIE,SAAf,IAA4BD,WAAW,IAAIE,SAA/C,EAA0D;AACxD,QAAIH,WAAW,GAAGE,SAAlB,EAA6B;AAC3B;AACA,UAAM7F,KAAK,GAAGwE,QAAQ,CAACsB,SAAS,GAAG,CAAb,CAAtB;AACAR,MAAAA,MAAM,GAAGtF,KAAK,GAAGA,KAAK,CAACd,MAAT,GAAkB,IAAhC;AACA8F,MAAAA,SAAS,CAACU,SAAD,EAAYJ,MAAZ,EAAoBd,QAApB,EAA8BoB,WAA9B,EAA2CE,SAA3C,CAAT;AACD,KALD,MAKO;AACL;AACAb,MAAAA,YAAY,CAACS,SAAD,EAAYrB,QAAZ,EAAsBsB,WAAtB,EAAmCE,SAAnC,CAAZ;AACD;AACF;AACF,EAED;;;AACA,SAAShC,WAAT,CAAqBF,QAArB,EAA+BC,QAA/B,EAAyC;AACvC,SAAOD,QAAQ,CAAC3E,GAAT,KAAiB4E,QAAQ,CAAC5E,GAA1B,IAAiC2E,QAAQ,CAAC9E,IAAT,KAAkB+E,QAAQ,CAAC/E,IAAnE;AACD,EAED;;;AACA,SAASyH,aAAT,CAAuBrH,QAAvB,EAAiCsG,KAAjC,EAAwCC,GAAxC,EAA6C;AAC3C,MAAIe,GAAG,GAAG,EAAV;;AACA,OAAK,IAAI7G,CAAC,GAAG6F,KAAb,EAAoB7F,CAAC,IAAI8F,GAAG,GAAGD,KAA/B,EAAsC7F,CAAC,EAAvC,EAA2C;AAAA,QAClCV,GADkC,GAC3BC,QAAQ,CAACS,CAAD,CADmB,CAClCV,GADkC;AAEzCuH,IAAAA,GAAG,CAACvH,GAAD,CAAH,GAAW,IAAX;AACD;;AACD,SAAOuH,GAAP;AACD;;;;;;;;;AChSD,IAAMC,KAAK,GAAG,SAARA,KAAQ,CAAAhF,EAAE,EAAI;AAACiF,EAAAA,OAAO,CAACC,OAAR,GAAkBC,IAAlB,CAAuBnF,EAAvB;AAA4B,CAAjD,EAAmD;;;AAEnD,IAAMoF,WAAW,GAAG,EAApB,EAEA;;AACO,SAASC,aAAT,CAAuBC,OAAvB,EAAgC;AACrC;AACA;AACA;AACA;AACA,MACE,CAACA,OAAO,CAAC1C,OAAT,KACC0C,OAAO,CAAC1C,OAAR,GAAkB,IADnB,KAEAwC,WAAW,CAACG,IAAZ,CAAiBD,OAAjB,MAA8B,CAHhC,EAIE;AACA;AACA;AACAN,IAAAA,KAAK,CAACQ,gBAAD,CAAL;AACD;AACF,EAED;;;AACA,SAASA,gBAAT,GAA4B;AAC1B,MAAIJ,WAAW,CAACnH,MAAhB,EAAwB;AACtB;AACAmH,IAAAA,WAAW,CAACK,IAAZ,GAFsB,CAItB;;AACA,QAAIC,UAAU,GAAGN,WAAW,CAACO,GAAZ,EAAjB;;AACA,WAAOD,UAAP,EAAmB;AAEjB;AACA;AACA;AACA,UAAIA,UAAU,CAAC9C,OAAf,EAAwB;AACtB;AACA8C,QAAAA,UAAU,CAACE,QAAX,GAFsB,CAItB;;;AACAC,QAAAA,aAAa,CAACH,UAAD,CAAb;AACD,OAXgB,CAYjB;;;AACAA,MAAAA,UAAU,GAAGN,WAAW,CAACO,GAAZ,EAAb;AACD;AACF;AACF,EAED;;;AACA,SAASE,aAAT,CAAuBP,OAAvB,EAAgC;AAC9B,MAAMQ,SAAS,GAAGR,OAAO,CAACS,mBAA1B;AACA,MAAIC,GAAJ;;AACA,MAAIF,SAAS,IAAIA,SAAS,CAAC7H,MAA3B,EAAmC;AACjC,WAAO+H,GAAG,GAAGF,SAAS,CAACG,KAAV,EAAb;AAAgCD,MAAAA,GAAG,CAACE,IAAJ,CAASZ,OAAT;AAAhC;AACD;AACF;;;;;;;;;ACtDD;;AACA;;;;;;;;;;IAEqBa;AAEnB;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA,qBAAY7I,KAAZ,EAAmB;AAAA;;AACjB,SAAKA,KAAL,GAAaA,KAAb;AACA,SAAKyI,mBAAL,GAA2B,EAA3B;AACD;;;;6BAEQ;AACP;AACA,aAAO,IAAP;AACD;;;oCAEe;AACd;AAEA;AACA,WAAKK,WAAL,GAAmB,KAAK9I,KAAxB;AACA,WAAK+I,WAAL,GAAmB,KAAKxE,KAAxB;AAEA,WAAKvE,KAAL,GAAa,KAAKqE,WAAlB;AACA,WAAKE,KAAL,GAAa,KAAKD,WAAlB;AAEA,WAAKA,WAAL,GAAmBvD,SAAnB;AACA,WAAKsD,WAAL,GAAmBtD,SAAnB,CAXc,CAad;;AACA,WAAKiI,OAAL,GAAe,KAAK5E,MAAL,EAAf;AACA,aAAO,KAAK4E,OAAZ;AACD,MAED;;;;6BACSC,UAAUC,UAAU;AAC3BpF,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAD2B,CAE3B;;AACA,UAAI,OAAOkF,QAAP,KAAoB,UAAxB,EAAoC;AAClCA,QAAAA,QAAQ,GAAGA,QAAQ,CAAC,KAAK1E,KAAN,EAAa,KAAKvE,KAAlB,CAAnB;AACD,OAL0B,CAO3B;;;AACA,WAAKsE,WAAL,gBACK,KAAKC,KADV,EAEK0E,QAFL,EAR2B,CAa3B;;AACAC,MAAAA,QAAQ,IAAI,KAAKT,mBAAL,CAAyBR,IAAzB,CAA8BiB,QAA9B,CAAZ;AACA,iCAAc,IAAd;AACD,MAED;;;;+BACW;AACT;AACA,UAAMrE,QAAQ,GAAG,KAAKmE,OAAtB;AAEA,WAAK3E,WAAL,GAAmB,KAAKrE,KAAxB;AACA,UAAI,CAAC,KAAKsE,WAAV,EAAuB,KAAKA,WAAL,GAAmB,KAAKC,KAAxB,CALd,CAOT;;AACA,WAAKyE,OAAL,GAAe,KAAKxE,aAAL,EAAf,CARS,CAUT;;AACA,sBAAKK,QAAL,EAAe,KAAKmE,OAApB;AAEA,WAAK1D,OAAL,GAAe,KAAf;AACD;;;;;;;;;;;;;;;ACtFH;;AACA;;;;AAEA,IAAM6D,QAAQ,GAAG;AACf7I,EAAAA,aAAa,EAAbA,sBADe;AAEfuI,EAAAA,SAAS,EAATA;AAFe,CAAjB;eAKeM;;;;;;;;;;ACRf;;;;AAEA,IAAMC,WAAW,GAAG;AAClBhF,EAAAA,MAAM,EAANA;AADkB,CAApB;eAIegF;;;;;;;;;;;;;;ACNf;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;IAEqBC;;;;;AACnB,oBAAc;AAAA;;AAAA;AAEb;;;;6BAEQ;AACP;AAAA;AAAA;AAAA,qBACoB;AADpB;AAAA;AAAA;AAAA;AAAA,mBAEe;AAFf;AAAA;AAAA;AAAA;AAAA,yBAGqB,MAHrB;AAAA,mBAGiCC,gBAHjC;AAAA,mBAG6C;AAH7C;AAAA;AAAA;AAAA;AAAA;AAAA,qBAIiB;AAJjB;AAAA;AAAA;AAAA;AAAA,2BAKuB;AALvB;AAAA;AAAA;AAAA;AAAA;AAAA,2BAMuB;AANvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAWD;;;;EAjBiCH,kBAASN;;;;;;;;;;;ACJ7C;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;IAEqBQ;;;;;AACnB,oBAAc;AAAA;;AAAA;AAEb;;;;6BAEQ;AACP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEmB;AAFnB;AAAA;AAAA;AAAA;AAAA;AAAA,uBAGmB;AAHnB;AAAA;AAAA;AAAA;AAAA,sBAGmC,QAHnC;AAAA,oBAGiD;AAHjD;AAAA;AAAA;AAAA;AAAA;AAMD;;;;EAZiCF,kBAASN;;;;;;;;;;;ACH7C;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;IAEqBU;;;;;AACnB,mBAAYvJ,KAAZ,EAAmB;AAAA;;AAAA,6BACXA,KADW;AAElB;;;;6BAEQ;AAAA;;AACP8D,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAK/D,KAAL,CAAWwJ,QAAvB;AACA;AAAA;AAAA;AAAA,qBACiB;AADjB;AAAA;AAAA;AAAA;AAAA,uBAEmB;AAFnB;AAAA,qBAE8B,KAAKxJ,KAAL,CAAWyJ,CAFzC;AAAA;AAAA;AAAA;AAAA,uBAGmB;AAHnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAK2B,KAAKzJ,KAAL,CAAWwJ,QAAX,IAAuB,KALlD;AAAA,yBAKkE;AAAA,yBAAM,KAAI,CAACxJ,KAAL,CAAWwC,GAAX,EAAN;AAAA;AALlE;AAAA;AAAA;AAAA;AAAA;AAAA,2BAM2B,KAAKxC,KAAL,CAAWwJ,QAAX,IAAuB,KANlD;AAAA,yBAMkE;AAAA,yBAAM,KAAI,CAACxJ,KAAL,CAAW0J,KAAX,EAAN;AAAA;AANlE;AAAA;AAAA;AAAA;AAAA;AAAA,2BAO2B,KAAK1J,KAAL,CAAWwJ,QAAX,IAAuB,KAPlD;AAAA,yBAOkE;AAAA,yBAAM,KAAI,CAACxJ,KAAL,CAAW2J,IAAX,EAAN;AAAA;AAPlE;AAAA;AAAA;AAAA;AAAA;AAAA,2BAQ2B,KAAK3J,KAAL,CAAWwJ,QAAX,IAAuB,KARlD;AAAA,yBAQkE;AAAA,yBAAM,KAAI,CAACxJ,KAAL,CAAW4J,KAAX,EAAN;AAAA;AARlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAUiB;AAVjB;AAAA;AAAA;AAAA;AAAA,yBAWyB;AAAA,yBAAI,KAAI,CAAC5J,KAAL,CAAW6J,WAAX,EAAJ;AAAA;AAXzB;AAAA;AAAA;AAAA;AAAA;AAAA,yBAYyB;AAAA,yBAAI,KAAI,CAAC7J,KAAL,CAAW8J,aAAX,EAAJ;AAAA;AAZzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBD;;;;EAxBkCX,kBAASN;;;;;;;;;;;ACH9C;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;IAEqBkB;;;;;AACnB,iBAAc;AAAA;;AAAA;;AACZ;AACA,UAAKxF,KAAL,GAAa;AACXkF,MAAAA,CAAC,EAAE,CADQ;AAEXO,MAAAA,QAAQ,EAAE,IAFC;AAGXC,MAAAA,IAAI,EAAE,IAHK;AAIXT,MAAAA,QAAQ,EAAE;AAJC,KAAb;;AAOA,UAAKU,IAAL,GAAY,UAACnK,IAAD,EAAU;AACpB,cAAQA,IAAR;AACE,aAAK,CAAL;AACE,gBAAKoK,QAAL,CAAc;AAACV,YAAAA,CAAC,EAAE,MAAKlF,KAAL,CAAWkF,CAAX,GAAe;AAAnB,WAAd;;AACA;;AACF,aAAK,CAAL;AACE,gBAAKU,QAAL,CAAc;AAACV,YAAAA,CAAC,EAAE,MAAKlF,KAAL,CAAWkF,CAAX,GAAe;AAAnB,WAAd;;AACA;;AACF,aAAK,CAAL;AACE,gBAAKU,QAAL,CAAc;AAACV,YAAAA,CAAC,EAAE,IAAI,MAAKlF,KAAL,CAAWkF;AAAnB,WAAd;;AACA;;AACF,aAAK,CAAL;AACE,gBAAKU,QAAL,CAAc;AAACV,YAAAA,CAAC,EAAE;AAAJ,WAAd;;AACA;;AACF;AACE,gBAAM,IAAIW,KAAJ,EAAN;AAdJ;AAgBD,KAjBD;;AAmBA,UAAKP,WAAL,GAAmB,YAAM;AACvB,UAAI,CAAC,MAAKtF,KAAL,CAAW0F,IAAhB,EAAsB,OAAO,KAAP;;AACtB,UAAMI,IAAI,gCAAV;;AACA,YAAKF,QAAL,CAAc;AACZX,QAAAA,QAAQ,EAAE,IADE;AAEZQ,QAAAA,QAAQ,EAAEH,WAAW,CAAC,YAAM;AAC1BQ,UAAAA,IAAI,CAACF,QAAL,CAAc;AACZV,YAAAA,CAAC,EAAEY,IAAI,CAAC9F,KAAL,CAAWkF,CAAX,GAAe;AADN,WAAd;AAGD,SAJoB,EAIlB,IAJkB,CAFT;AAOZQ,QAAAA,IAAI,EAAE;AAPM,OAAd;AASD,KAZD;;AAcA,UAAKH,aAAL,GAAqB,YAAM;AACzB,UAAI,MAAKvF,KAAL,CAAW0F,IAAX,KAAoB,KAAxB,EAA+B;AAC7BH,QAAAA,aAAa,CAAC,MAAKvF,KAAL,CAAWyF,QAAZ,CAAb;AACAM,QAAAA,MAAM,CAACC,KAAP,CAAa,QAAb;AACD;;AACD,YAAKJ,QAAL,CAAc;AACZF,QAAAA,IAAI,EAAE,IADM;AAEZD,QAAAA,QAAQ,EAAE,IAFE;AAGZR,QAAAA,QAAQ,EAAE;AAHE,OAAd;AAKD,KAVD;;AA1CY;AAsDb;;;;6BAEQ;AAAA;;AACP;AAAA;AAAA;AAAA,qBACiB;AADjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAIyB,KAAKjF,KAAL,CAAWiF,QAJpC;AAAA,iBAIiD,KAAKjF,KAAL,CAAWkF,CAJ5D;AAAA,wBAIyE,KAAKlF,KAAL,CAAWyF,QAJpF;AAAA,mBAKoB;AAAA,uBAAM,MAAI,CAACE,IAAL,CAAU,CAAV,CAAN;AAAA,eALpB;AAAA,qBAK+C;AAAA,uBAAM,MAAI,CAACA,IAAL,CAAU,CAAV,CAAN;AAAA,eAL/C;AAAA,oBAMqB;AAAA,uBAAM,MAAI,CAACA,IAAL,CAAU,CAAV,CAAN;AAAA,eANrB;AAAA,qBAOsB;AAAA,uBAAM,MAAI,CAACA,IAAL,CAAU,CAAV,CAAN;AAAA,eAPtB;AAAA,2BAOuD;AAAA,uBAAM,MAAI,CAACL,WAAL,EAAN;AAAA,eAPvD;AAAA,6BAQ8B;AAAA,uBAAM,MAAI,CAACC,aAAL,EAAN;AAAA;AAR9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaD;;;;EAvE8BX,kBAASN;;;;;;ACN1C;;AACA;;AACA;;;;AAEAO,qBAAYhF,MAAZ;AAAA;AAAA;AAAA;AAAA,IACEjD,QAAQ,CAACqJ,cAAT,CAAwB,MAAxB,CADF","file":"simple-react.25d78f03.js","sourceRoot":"..","sourcesContent":["// 创建一个虚拟dom\r\nexport function createVNode(type, props, ref, key, children, domElm, text) {\r\n  return {\r\n    type, //标签类型\r\n    props,  //标签属性\r\n    children, //子组件\r\n    ref,  //获取DOM元素\r\n    key,  //唯一标识\r\n    domElm,  //DOM元素\r\n    text, //文本内容\r\n  };\r\n}\r\n\r\nexport default function createElement(tag) {\r\n  const {elementName: type, attributes: data, children} = tag;\r\n  const {key, ref, ...props} = data;\r\n\r\n  // 处理子级列表中的 string or number 同样转换为 VNode\r\n  if (children && children.length) {\r\n    const length = children.length;\r\n    for (let i = 0; i < length; i++) {\r\n      const child = children[i];  //对每一个子节点进行遍历\r\n      if (['string', 'number'].includes(typeof child)) {\r\n        // 非标签的文字节点， vnode.type === undefined\r\n        children[i] = createVNode(\r\n          undefined,\r\n          {},\r\n          undefined,\r\n          undefined,\r\n          undefined,\r\n          undefined,\r\n          String(children[i])\r\n        );\r\n      }\r\n    }\r\n  }\r\n  return createVNode(type, props, ref, key, children, undefined, undefined);\r\n}","/*\r\n  原生dom操作\r\n* */\r\n\r\nconst dom = {\r\n  //根据vnode.type创建dom元素\r\n  createElement(vnode) {\r\n    return document.createElement(vnode.type);\r\n  },\r\n\r\n  //创建text节点\r\n  createTextNode(text) {\r\n    return document.createTextNode(text);\r\n  },\r\n\r\n  //修改文本节点的值\r\n  setTextContent(domElm, content) {\r\n    if (domElm && ['string', 'number'].includes(typeof content)) {\r\n      domElm.nodeValue = content;\r\n    }\r\n  },\r\n\r\n  //得到父元素\r\n  getParentNode(elm) {\r\n    return elm && elm.parentNode;\r\n  },\r\n\r\n  //增加子元素\r\n  appendChild(parent, child) {\r\n    parent.appendChild(child);\r\n  },\r\n\r\n  //删除指定子元素\r\n  removeChild(parent, child) {\r\n    if (child && parent && child.parentNode) {\r\n      parent.removeChild(child);\r\n    }\r\n  },\r\n\r\n  //获取兄弟元素\r\n  getNextSibling(domElm) {\r\n    return domElm.nextSibling === null ? false : domElm.nextSibling;\r\n  },\r\n\r\n  //在前边插入节点\r\n  insertBefore(parent, newNode, refNode) {\r\n    if (refNode) {\r\n      parent.insertBefore(newNode, refNode);\r\n    } else {\r\n      dom.appendChild(parent, newNode);\r\n    }\r\n  },\r\n\r\n  //在后边插入节点\r\n  insertAfter(newNode, refNode) {\r\n    const parent = refNode.parentNode;\r\n    if (parent.lastChild === refNode) {\r\n      parent.appendChild(newNode);\r\n    } else {\r\n      parent.insertBefore(newNode, refNode.nextSibling);\r\n    }\r\n  },\r\n\r\n  //绑定class\r\n  addClass(domElm, className) {\r\n    domElm.classList.add(className);\r\n  },\r\n\r\n  //绑定事件\r\n  bindEvent(domElm, type, fn) {\r\n    domElm.addEventListener(type, fn);\r\n  },\r\n\r\n  //解绑事件\r\n  removeEvent(domElm, type, fn) {\r\n    domElm.removeEventListener(type, fn);\r\n  },\r\n\r\n  //设置属性\r\n  setAttr(domElm, key, value) {\r\n    domElm.setAttribute(key, value);\r\n  },\r\n\r\n  //删除属性\r\n  removeAttr(domElm, key) {\r\n    domElm.removeAttribute(key);\r\n  },\r\n\r\n};\r\nexport default dom;","import dom from \"../utils/dom\";\r\nimport {createVNode} from \"../main_methods/createElement\";\r\n\r\n// 创建dom元素：虚拟dom => dom\r\nexport function createDomElement(vnode) {\r\n  //type为function：组件元素\r\n  //先render出vnode节点\r\n\r\n  if (Array.isArray(vnode)) {\r\n    //如果是vnode是列表，则为他们增加父节点\r\n    vnode = createVNode('div', undefined, undefined, undefined, vnode, undefined);\r\n  }\r\n  if (typeof vnode.type === 'function') {\r\n    /**********    组件 ==> 组件实例 ==> 元素节点（elVNode）    ***********/\r\n    vnode = renderComponent(vnode);\r\n  }\r\n  const {children, type, text, props} = vnode;\r\n\r\n  if (type && typeof type === 'string') {\r\n    //type为字符串：dom元素\r\n    vnode.domElm = dom.createElement(vnode);//创建当前dom元素\r\n    if (Array.isArray(children)) {\r\n      //递归创建子元素\r\n      for (let i = 0; i < children.length; i++) {\r\n        dom.appendChild(vnode.domElm, createDomElement(children[i]));\r\n      }\r\n    }\r\n  } else if ((type === undefined || type === null) && text) {\r\n    //type为undefined：文本节点\r\n    vnode.domElm = dom.createTextNode(text);\r\n  }\r\n\r\n  if (vnode.domElm) {//如果创建成功了，则设置dom元素的属性\r\n    setDomProps(vnode.domElm, props);\r\n    return vnode.domElm;\r\n  } else {  //创建失败，则renderComponent后的vnode依然是组件节点，需要递归rener\r\n    return createDomElement(vnode);\r\n  }\r\n}\r\n\r\n// 为dom元素设置属性\r\nexport function setDomProps(domElm, props) {\r\n  if (domElm && typeof props === 'object') {\r\n    const keys = Object.keys(props);\r\n    for (let i = 0; i < keys.length; i++) {\r\n\r\n      const key = keys[i];\r\n      const value = props[key];\r\n\r\n      if (key.startsWith('on')) {\r\n        // 事件绑定\r\n        if (typeof value === 'function') {\r\n          const eventName = key.substring(2).toLowerCase();  // 去出on之后的字符串并转换为小写\r\n          dom.bindEvent(domElm, eventName, value);\r\n        } else {\r\n          console.log('invalid eventHandler');\r\n        }\r\n      } else if (key === 'className') {\r\n        // 添加class\r\n        dom.addClass(domElm, value);\r\n      } else {\r\n        // 属性设置\r\n        dom.setAttr(domElm, key, value);\r\n      }\r\n\r\n    }\r\n  }\r\n}\r\n\r\n/**********    组件 ==> 组件实例 ==> 元素节点（elVNode）    ***********/\r\nexport function renderComponent(compVNode) {\r\n  const {type: Comp, props} = compVNode;  //compVNode：组件； instance：组件实例。  vnode：元素节点；\r\n  let instance = compVNode.instance;\r\n  // 当 instance 已经存在时，则不需要重新创建实例\r\n  if (!instance) {\r\n    // 传入 props，初始化组件实例\r\n    // 支持：类组件、函数组件\r\n    if (Comp.prototype && Comp.prototype.render) {\r\n      instance = new Comp(props);\r\n    }\r\n\r\n    // 初次渲染时：将来的属性与状态其实便是与当前值一致\r\n    instance.__nextProps = props;\r\n    instance.__nextState = instance.state;\r\n  }\r\n\r\n  // 调用 render 获取元素节点 VNode\r\n  const vnode = instance.__createVNode();\r\n\r\n  // 组件、元素、实例之间保持相互引用，有利于双向连接整棵虚拟树\r\n  instance.__component = compVNode; //组件\r\n  compVNode.instance = instance;  //组件实例\r\n  compVNode.vnode = vnode;    //元素节点\r\n  vnode.component = compVNode;  //组件\r\n\r\n  return vnode;\r\n}\r\n\r\n// 渲染函数\r\nexport default function render(vnode, parentDom) {\r\n  const domElm = createDomElement(vnode); //创建dom元素\r\n  dom.appendChild(parentDom, domElm);  //将dom元素插入父节点\r\n  return domElm;\r\n}","import dom from \"../utils/dom\";\r\nimport {createDomElement, renderComponent, setDomProps} from \"./render\";\r\n\r\n//新旧节点相同：diff算法\r\nexport function diff(oldVNode, newVNode) {\r\n  if (isSameVNode(oldVNode, newVNode)) {\r\n    if (typeof oldVNode.type === 'function') {\r\n      // 组件节点\r\n      diffComponent(oldVNode, newVNode);\r\n    } else {\r\n      // 元素节点，直接执行比对\r\n      diffVNode(oldVNode, newVNode);\r\n    }\r\n  } else {\r\n    console.log('not same vnode');\r\n    replaceVNode(oldVNode, newVNode);\r\n  }\r\n}\r\n\r\n//组件节点diff\r\nfunction diffComponent(oldCompVNode, newCompVNode) {\r\n  const {instance, vnode: oldVNode, elm} = oldCompVNode;\r\n  const {props: nextProps} = newCompVNode;\r\n\r\n  if (instance && oldVNode) {\r\n    instance.__dirty = false;\r\n\r\n    // 更新状态和属性\r\n    instance.__nextProps = nextProps;\r\n    if (!instance.__nextState) instance.__nextState = instance.state;\r\n\r\n    // 复用旧组件实例和元素\r\n    newCompVNode.instance = instance;\r\n    newCompVNode.elm = elm;\r\n\r\n    // 使用新属性、新状态，旧组件实例\r\n    // 重新生成 新虚拟DOM\r\n    const newVNode = renderComponent(newCompVNode);\r\n\r\n    // 递归触发 diff\r\n    diff(oldVNode, newVNode);\r\n  }\r\n}\r\n\r\n//元素节点diff\r\nfunction diffVNode(oldVNode, newVNode) {\r\n\r\n  const {domElm, children: oldChild, text: oldText, props: oldProps} = oldVNode;\r\n  const {children: newChild, text: newText, props: newProps} = newVNode;\r\n\r\n  if (oldVNode === newVNode || !domElm) return;\r\n\r\n  // 节点相同，dom类型一定相同\r\n  newVNode.domElm = domElm;\r\n\r\n  //更新属性\r\n  diffProps(domElm, oldProps, newProps);\r\n\r\n  const hasOldChild = Boolean(oldChild && oldChild.length);\r\n  const hasNewChild = Boolean(newChild && newChild.length);\r\n\r\n  if (newText !== undefined) {\r\n    //新节点是文本节点\r\n    dom.setTextContent(domElm, newText);\r\n  } else {\r\n    // 新节点是元素节点\r\n    if (hasOldChild && hasNewChild) {\r\n      // 新旧节点均存在子级列表时，直接 diff 列表\r\n      if (oldChild !== newChild) diffChildren(domElm, oldChild, newChild);\r\n    } else if (hasNewChild) {\r\n      // 旧节点不包含子级，而新节点包含子级：直接新增新子级\r\n      addVNodes(domElm, null, newChild, 0, newChild.length - 1);\r\n    } else if (hasOldChild) {\r\n      // 新子级不包含元素，而旧节点包含子级：则需要删除旧子级\r\n      removeVNodes(domElm, oldChild, 0, oldChild.length - 1);\r\n    }\r\n    // else if (oldText !== undefined) {\r\n    // 当新旧均无子级\r\n    // 这里有可能存在 <Text> 标签，且新内容为空\r\n    // 因此直接清空旧元素文字\r\n    // dom.setTextContent(domElm, '');\r\n    // }\r\n  }\r\n}\r\n\r\n//新旧节点不同：直接替换\r\nfunction replaceVNode(oldVNode, newVNode) {\r\n\r\n  const {domElm: oldDomElm} = oldVNode;\r\n  const parentDom = dom.getParentNode(oldDomElm);\r\n\r\n  //删除旧dom\r\n  dom.removeChild(parentDom, oldDomElm);\r\n  //创建新dom\r\n  const newDomElm = createDomElement(newVNode);\r\n  dom.appendChild(parentDom, newDomElm);\r\n\r\n}\r\n\r\nfunction diffProps(domElm, oldProps, newProps) {\r\n  if (oldProps === newProps || !domElm) return;\r\n  if (typeof oldProps === 'object' && typeof newProps === 'object') {\r\n    let keys = Object.keys(oldProps);\r\n\r\n    //处理旧属性\r\n    for (let i = 0; i < keys.length; i++) {\r\n      const key = keys[i];\r\n      const oldV = oldProps[key], newV = newProps[key];\r\n\r\n      if (key === 'className' && oldV === 'ban') console.log(key, oldV, newV);\r\n\r\n      if (key.startsWith(\"on\")) {\r\n        //处理事件\r\n        if (typeof oldV === 'function' && oldV !== newV) {\r\n          //当存在旧事件，且新旧值不一致时：事件解绑\r\n          const eventName = key.substring(2).toLowerCase();\r\n          dom.removeEvent(domElm, eventName, oldV);\r\n        }\r\n      } else {\r\n        //普通属性处理\r\n        if (newV === undefined || (key === 'className' && (newV === false || newV === null))) {\r\n          // 若oldVNode中的属性在newVNode中不存在，则直接删除\r\n          // class属性需要特殊处理\r\n          dom.removeAttr(domElm, key === 'className' ? 'class' : key);\r\n        }\r\n      }\r\n    }\r\n\r\n    // 设置新属性\r\n    setDomProps(domElm, newProps);\r\n  }\r\n}\r\n\r\n//添加vnodes\r\nfunction addVNodes(domElm, before, children, start, end) {\r\n  for (let i = 0; i < end - start; i++) {\r\n    let newDom = children[i].domElm || createDomElement(children[i]);\r\n    dom.insertAfter(newDom, before);\r\n    before = newDom;\r\n  }\r\n}\r\n\r\n//删除vnodes\r\nfunction removeVNodes(domElm, children, start, end) {\r\n  for (let i = 0; i < end - start; i++) {\r\n    dom.removeChild(domElm, children[i]);\r\n  }\r\n}\r\n\r\n//对比子级列表\r\nfunction diffChildren(parentElm, oldChild, newChild) {\r\n\r\n  /**\r\n   * 更新子级列表\r\n   * 双列表游标 + while\r\n   */\r\n\r\n    // 初始化游标\r\n  let oldStartIdx = 0, newStartIdx = 0;\r\n  let oldEndIdx = oldChild.length - 1, newEndIdx = newChild.length - 1;\r\n\r\n  // 列表首尾节点\r\n  let oldStartVNode = oldChild[0], oldEndVNode = oldChild[oldEndIdx];\r\n  let newStartVNode = newChild[0], newEndVNode = newChild[newEndIdx];\r\n\r\n  let oldKeyToIdx, idxInOld, elmToMove, before;\r\n\r\n  /**\r\n   * 当起始游标 < 终止游标时，\r\n   * 表示列表中仍有未 diff 的节点\r\n   * 进入循环\r\n   */\r\n  while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {\r\n    /**\r\n     * 1. 排除非有效的节点\r\n     * 剔除列表中包含的 undefined || false || null\r\n     */\r\n    if (oldStartVNode == null) oldStartVNode = oldChild[++oldStartIdx];\r\n    else if (oldEndVNode == null) oldEndVNode = oldChild[--oldEndIdx];\r\n    else if (newStartVNode == null) newStartVNode = newChild[++newStartIdx];\r\n    else if (newEndVNode == null) newEndVNode = newChild[--newEndIdx];\r\n    else if (isSameVNode(oldStartVNode, newStartVNode)) {\r\n      /**\r\n       * 2. 正反向两两比对列表首项与末项匹配成功\r\n       * 移动游标，递归 diff 两个节点\r\n       * 均未匹配上，则进入 3. key 值比对\r\n       */\r\n      diff(oldStartVNode, newStartVNode);\r\n\r\n      oldStartVNode = oldChild[++oldStartIdx];\r\n      newStartVNode = newChild[++newStartIdx];\r\n    } else if (isSameVNode(oldEndVNode, newEndVNode)) {\r\n\r\n      diff(oldEndVNode, newEndVNode);\r\n\r\n      oldEndVNode = oldChild[--oldEndIdx];\r\n      newEndVNode = newChild[--newEndIdx];\r\n    } else if (isSameVNode(oldStartVNode, newEndVNode)) {\r\n\r\n      dom.insertBefore(parentElm, oldStartVNode.domElm, dom.getNextSibling(oldEndVNode.domElm));\r\n      diff(oldStartVNode, newEndVNode);\r\n\r\n      oldStartVNode = oldChild[++oldStartIdx];\r\n      newEndVNode = newChild[--newEndIdx];\r\n    } else if (isSameVNode(oldEndVNode, newStartVNode)) {\r\n\r\n      dom.insertBefore(parent, oldEndVNode.domElm, oldStartVNode.domElm);\r\n      diff(oldEndVNode, newStartVNode);\r\n\r\n      oldEndVNode = oldChild[--oldEndIdx];\r\n      newStartVNode = newChild[++newStartIdx];\r\n    } else {\r\n      /**\r\n       * 3. 两端比对均不匹配\r\n       * 进入 key 值比对\r\n       */\r\n      // 根据剩余的旧列表创建 key list\r\n      if (!oldKeyToIdx) oldKeyToIdx = createKeyList(oldChild, oldStartIdx, oldEndIdx);\r\n\r\n      // 判断新列表项的 key值 是否存在\r\n      idxInOld = oldKeyToIdx[newStartVNode.key || ''];\r\n      if (!idxInOld) {\r\n        /*\r\n         * 4. 新 key 值在旧列表中不存在\r\n         * 直接将该节点插入\r\n        */\r\n        dom.insertBefore(parentElm, createDomElement(newStartVNode), oldStartVNode.domElm);\r\n        newStartVNode = newChild[++newStartIdx];\r\n      } else {\r\n        /*\r\n        * 5. 新 key 在旧列表中存在时\r\n        * 继续判断是否为同类型节点\r\n        */\r\n        elmToMove = oldChild[idxInOld];\r\n        if (isSameVNode(elmToMove, newStartVNode)) {\r\n          /*\r\n          * 6. 新旧节点类型一致\r\n          * key 有效，直接移动并 diff\r\n          */\r\n          dom.insertBefore(parentElm, elmToMove.domElm, oldStartVNode.domElm);\r\n          diff(elmToMove, newStartVNode);\r\n\r\n          // 清空旧列表项\r\n          // 后续的比对可以直接跳过\r\n          oldChild[idxInOld] = undefined;\r\n        } else {\r\n          /*\r\n           * 7. 新旧节点类型不一致\r\n           * key 效，直接创建元素并插入\r\n          */\r\n          dom.insertBefore(parentElm, createDomElement(newStartVNode), oldStartVNode.domElm);\r\n        }\r\n        newStartVNode = newChild[++newStartIdx];\r\n      }\r\n    }\r\n  }\r\n\r\n  /*\r\n   * 8. 当有游标列表为空时，则结束循环，进入策略3\r\n   * 当 旧列表为空 时，则创建并插入新列表中的剩余节点\r\n   * 当 新列表为空 时，则删除旧列表中的剩余节点\r\n  */\r\n  if (oldStartIdx <= oldEndIdx || newStartIdx <= newEndIdx) {\r\n    if (oldStartIdx > oldEndIdx) {\r\n      // 新增节点\r\n      const vnode = newChild[newEndIdx + 1];\r\n      before = vnode ? vnode.domElm : null;\r\n      addVNodes(parentElm, before, newChild, newStartIdx, newEndIdx);\r\n    } else {\r\n      // 删除节点\r\n      removeVNodes(parentElm, oldChild, oldStartIdx, oldEndIdx);\r\n    }\r\n  }\r\n}\r\n\r\n// 对比两vnode是否是相同的\r\nfunction isSameVNode(oldVNode, newVNode) {\r\n  return oldVNode.key === newVNode.key && oldVNode.type === newVNode.type;\r\n}\r\n\r\n//工具函数 创建key列表\r\nfunction createKeyList(children, start, end) {\r\n  let map = {};\r\n  for (let i = start; i <= end - start; i++) {\r\n    const {key} = children[i];\r\n    map[key] = true;\r\n  }\r\n  return map;\r\n}","const defer = fn => {Promise.resolve().then(fn);}; //微任务 不阻塞宏任务（渲染等\r\n\r\nconst updateQueue = [];\r\n\r\n// 队列更新 API\r\nexport function enqueueRender(updater) {\r\n  // 将所有 updater 同步推入更新队列中\r\n  // 为实例添加一个属性 __dirty，标识是否处于待更新状态\r\n  // 初始 和 更新完毕，该值会被置为 false\r\n  // 推入队列时，标记为 true\r\n  if (\r\n    !updater.__dirty &&\r\n    (updater.__dirty = true) &&\r\n    updateQueue.push(updater) === 1\r\n  ) {\r\n    // 异步化冲洗队列\r\n    // 最终只执行一次冲洗\r\n    defer(flushRenderQueue);\r\n  }\r\n}\r\n\r\n// 合并一次循环中多次 updater\r\nfunction flushRenderQueue() {\r\n  if (updateQueue.length) {\r\n    // 排序更新队列\r\n    updateQueue.sort();\r\n\r\n    // 循环队列出栈\r\n    let curUpdater = updateQueue.pop();\r\n    while (curUpdater) {\r\n\r\n      // 当组件处于 待更新态 时，触发组件更新\r\n      // 如果该组件已经被更新完毕，则该状态为 false\r\n      // 则后续的更新均不再执行\r\n      if (curUpdater.__dirty) {\r\n        // 调用组件自身的更新函数\r\n        curUpdater.__update();\r\n\r\n        // 执行 callback\r\n        flushCallback(curUpdater);\r\n      }\r\n      // curUpdater.__dirty = false;\r\n      curUpdater = updateQueue.pop();\r\n    }\r\n  }\r\n}\r\n\r\n// 执行缓存在 updater.__setStateCallbacks 上的回调\r\nfunction flushCallback(updater) {\r\n  const callbacks = updater.__setStateCallbacks;\r\n  let cbk;\r\n  if (callbacks && callbacks.length) {\r\n    while (cbk = callbacks.shift()) cbk.call(updater);\r\n  }\r\n}","import {diff} from \"../dom_methods/diff\";\r\nimport {enqueueRender} from \"./update\";\r\n\r\nexport default class Component {\r\n\r\n  // 通过保持三份不同的时期的快照\r\n  // 有利于对组件的状态及属性的管理和追踪\r\n\r\n  // 属性\r\n  // public __prevProps\r\n  // public props = {}\r\n  // public __nextProps\r\n\r\n  // 状态\r\n  // public __prevState\r\n  // public state = {}\r\n  // public __nextState\r\n\r\n  // 储存当前组件渲染出的VNode\r\n  // public __vnode\r\n\r\n  // 储存组件节点\r\n  // public __component\r\n\r\n  constructor(props) {\r\n    this.props = props;\r\n    this.__setStateCallbacks = [];\r\n  }\r\n\r\n  render() {\r\n    //由组件实例实现\r\n    return null;\r\n  }\r\n\r\n  __createVNode() {\r\n    // 该方法用于封装重新执行 render 的逻辑\r\n\r\n    // state 与 props 状态变更的逻辑\r\n    this.__prevProps = this.props;\r\n    this.__prevState = this.state;\r\n\r\n    this.props = this.__nextProps;\r\n    this.state = this.__nextState;\r\n\r\n    this.__nextState = undefined;\r\n    this.__nextProps = undefined;\r\n\r\n    // 重新执行 render 生成 VNode\r\n    this.__vnode = this.render();\r\n    return this.__vnode;\r\n  }\r\n\r\n  //更新state\r\n  setState(operater, callback) {\r\n    console.log('setstate');\r\n    // 合并状态, 暂存于即将更新态中\r\n    if (typeof operater === 'function') {\r\n      operater = operater(this.state, this.props);\r\n    }\r\n\r\n    //setState帮你合并\r\n    this.__nextState = {\r\n      ...this.state,\r\n      ...operater,\r\n    };\r\n\r\n    // 调用更新，并执行回调\r\n    callback && this.__setStateCallbacks.push(callback);\r\n    enqueueRender(this);\r\n  }\r\n\r\n  //更新状态，调用diff\r\n  __update() {\r\n    // 临时存储 旧虚拟节点 (oldVNode)\r\n    const oldVNode = this.__vnode;\r\n\r\n    this.__nextProps = this.props;\r\n    if (!this.__nextState) this.__nextState = this.state;\r\n\r\n    // 重新生成 新虚拟节点(newVNode)\r\n    this.__vnode = this.__createVNode();\r\n\r\n    // 调用 diff，更新 VNode\r\n    diff(oldVNode, this.__vnode);\r\n\r\n    this.__dirty = false;\r\n  };\r\n}","import createElement from \"./main_methods/createElement\";\r\nimport Component from \"./main_methods/Component\";\r\n\r\nconst SmpReact = {\r\n  createElement,\r\n  Component\r\n};\r\n\r\nexport default SmpReact;","import render from \"./dom_methods/render\";\r\n\r\nconst SmpReactDom = {\r\n  render,\r\n};\r\n\r\nexport default SmpReactDom;","import SmpReact from \"../../SmpReact/SmpReact\";\r\nimport imgsrc from \"../../assets/gamepad.png\";\r\nimport \"./style.css\";\r\n\r\nexport default class Footer extends SmpReact.Component {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <header className=\"wrapper\">\r\n        <div class=\"box\">\r\n          <img className=\"logo\" src={imgsrc} alt=\"\"/>\r\n          <div class=\"textWrapper\">\r\n            <div className=\"title\">Counter-Demo</div>\r\n            <div className=\"tips\">powered by SmpReact</div>\r\n          </div>\r\n        </div>\r\n      </header>\r\n    );\r\n  }\r\n}","import SmpReact from \"../../SmpReact/SmpReact\";\r\nimport \"./style.css\";\r\n\r\nexport default class Footer extends SmpReact.Component {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <footer>\r\n        <div className=\"txt\">Oliver-ysq</div>\r\n        <div className=\"txt\"><a target=\"_blank\" href=\"https://github.com/Oliver-Ysq\">https://github.com/Oliver-Ysq</a>\r\n        </div>\r\n      </footer>);\r\n  }\r\n}","import SmpReact from \"../../SmpReact/SmpReact\";\r\nimport \"./style.css\";\r\n\r\nexport default class Counter extends SmpReact.Component {\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  render() {\r\n    console.log(this.props.disabled)\r\n    return (\r\n      <div className=\"listWrapper\">\r\n        <div className=\"display\">{this.props.n}</div>\r\n        <div className=\"btnWrapper\">\r\n          <div>\r\n            <button className={this.props.disabled && 'ban'} onClick={() => this.props.add()}>+1</button>\r\n            <button className={this.props.disabled && 'ban'} onClick={() => this.props.minus()}>-1</button>\r\n            <button className={this.props.disabled && 'ban'} onClick={() => this.props.mult()}>×2</button>\r\n            <button className={this.props.disabled && 'ban'} onClick={() => this.props.clear()}>clear</button>\r\n          </div>\r\n          <div class=\"secondLine\">\r\n            <button onClick={()=>this.props.setInterval()}>setInterval</button>\r\n            <button onClick={()=>this.props.clearInterval()}>clearInterval</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}","import SmpReact from \"./src/SmpReact/SmpReact\";\r\nimport \"./App.css\";\r\nimport Header from \"./src/components/Header/Header\";\r\nimport Footer from \"./src/components/Footer/Footer\";\r\nimport Counter from \"./src/components/Counter/Counter\";\r\n\r\nexport default class App extends SmpReact.Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      n: 0,\r\n      interval: null,\r\n      flag: true,\r\n      disabled: false\r\n    };\r\n\r\n    this.calc = (type) => {\r\n      switch (type) {\r\n        case 0:\r\n          this.setState({n: this.state.n + 1});\r\n          break;\r\n        case 1:\r\n          this.setState({n: this.state.n - 1});\r\n          break;\r\n        case 2:\r\n          this.setState({n: 2 * this.state.n});\r\n          break;\r\n        case 3:\r\n          this.setState({n: 0});\r\n          break;\r\n        default:\r\n          throw new Error();\r\n      }\r\n    };\r\n\r\n    this.setInterval = () => {\r\n      if (!this.state.flag) return false;\r\n      const that = this;\r\n      this.setState({\r\n        disabled: true,\r\n        interval: setInterval(() => {\r\n          that.setState({\r\n            n: that.state.n + 1\r\n          });\r\n        }, 1000),\r\n        flag: false\r\n      });\r\n    };\r\n\r\n    this.clearInterval = () => {\r\n      if (this.state.flag === false) {\r\n        clearInterval(this.state.interval);\r\n        window.alert(\"定时器已关闭\");\r\n      }\r\n      this.setState({\r\n        flag: true,\r\n        interval: null,\r\n        disabled: false\r\n      });\r\n    };\r\n\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"page\">\r\n        <Header/>\r\n        <main>\r\n          <Counter disabled={this.state.disabled} n={this.state.n} interval={this.state.interval}\r\n                   add={() => this.calc(0)} minus={() => this.calc(1)}\r\n                   mult={() => this.calc(2)}\r\n                   clear={() => this.calc(3)} setInterval={() => this.setInterval()}\r\n                   clearInterval={() => this.clearInterval()}/>\r\n        </main>\r\n        <Footer/>\r\n      </div>\r\n    );\r\n  }\r\n}","import SmpReact from \"./src/SmpReact/SmpReact\";\r\nimport SmpReactDom from \"./src/SmpReact/SmpReactDom\";\r\nimport App from \"./App\";\r\n\r\nSmpReactDom.render(<App/>,\r\n  document.getElementById(\"root\"));"]}