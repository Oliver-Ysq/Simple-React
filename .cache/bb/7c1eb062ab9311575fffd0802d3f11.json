{"id":"gvwW","dependencies":[{"name":"E:\\project\\simple-react\\.babelrc","includedInParent":true,"mtime":1607879288916},{"name":"E:\\project\\simple-react\\package.json","includedInParent":true,"mtime":1607879679708}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.enqueueRender=r;var e=function(e){Promise.resolve().then(e)},t=[];function r(r){!r.__dirty&&(r.__dirty=!0)&&1===t.push(r)&&e(o)}function o(){if(t.length){t.sort();for(var e=t.pop();e;)e.__dirty&&(e.__update(),n(e)),e=t.pop()}}function n(e){var t,r=e.__setStateCallbacks;if(r&&r.length)for(;t=r.shift();)t.call(e)}"},"sourceMaps":{"js":{"mappings":[{"source":"src/SmpReact/main_methods/update.js","original":{"line":55,"column":1},"generated":{"line":1,"column":0}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":55,"column":1},"generated":{"line":1,"column":13}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":55,"column":1},"generated":{"line":1,"column":20}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":55,"column":1},"generated":{"line":1,"column":35}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":55,"column":1},"generated":{"line":1,"column":43}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":55,"column":1},"generated":{"line":1,"column":56}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":55,"column":1},"generated":{"line":1,"column":57}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":55,"column":1},"generated":{"line":1,"column":64}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":55,"column":1},"generated":{"line":1,"column":68}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":55,"column":1},"generated":{"line":1,"column":76}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":55,"column":1},"generated":{"line":1,"column":90}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":1,"column":0},"generated":{"line":1,"column":92}},{"source":"src/SmpReact/main_methods/update.js","name":"defer","original":{"line":1,"column":6},"generated":{"line":1,"column":96}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":1,"column":14},"generated":{"line":1,"column":98}},{"source":"src/SmpReact/main_methods/update.js","name":"fn","original":{"line":1,"column":14},"generated":{"line":1,"column":107}},{"source":"src/SmpReact/main_methods/update.js","name":"Promise","original":{"line":1,"column":21},"generated":{"line":1,"column":110}},{"source":"src/SmpReact/main_methods/update.js","name":"resolve","original":{"line":1,"column":29},"generated":{"line":1,"column":118}},{"source":"src/SmpReact/main_methods/update.js","name":"then","original":{"line":1,"column":39},"generated":{"line":1,"column":128}},{"source":"src/SmpReact/main_methods/update.js","name":"fn","original":{"line":1,"column":44},"generated":{"line":1,"column":133}},{"source":"src/SmpReact/main_methods/update.js","name":"updateQueue","original":{"line":3,"column":6},"generated":{"line":1,"column":137}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":3,"column":20},"generated":{"line":1,"column":139}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":6,"column":7},"generated":{"line":1,"column":142}},{"source":"src/SmpReact/main_methods/update.js","name":"enqueueRender","original":{"line":6,"column":16},"generated":{"line":1,"column":151}},{"source":"src/SmpReact/main_methods/update.js","name":"updater","original":{"line":6,"column":30},"generated":{"line":1,"column":153}},{"source":"src/SmpReact/main_methods/update.js","name":"updater","original":{"line":12,"column":5},"generated":{"line":1,"column":157}},{"source":"src/SmpReact/main_methods/update.js","name":"__dirty","original":{"line":12,"column":13},"generated":{"line":1,"column":159}},{"source":"src/SmpReact/main_methods/update.js","name":"updater","original":{"line":13,"column":5},"generated":{"line":1,"column":169}},{"source":"src/SmpReact/main_methods/update.js","name":"__dirty","original":{"line":13,"column":13},"generated":{"line":1,"column":171}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":13,"column":23},"generated":{"line":1,"column":180}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":14,"column":34},"generated":{"line":1,"column":184}},{"source":"src/SmpReact/main_methods/update.js","name":"updateQueue","original":{"line":14,"column":4},"generated":{"line":1,"column":188}},{"source":"src/SmpReact/main_methods/update.js","name":"push","original":{"line":14,"column":16},"generated":{"line":1,"column":190}},{"source":"src/SmpReact/main_methods/update.js","name":"updater","original":{"line":14,"column":21},"generated":{"line":1,"column":195}},{"source":"src/SmpReact/main_methods/update.js","name":"defer","original":{"line":18,"column":4},"generated":{"line":1,"column":199}},{"source":"src/SmpReact/main_methods/update.js","name":"flushRenderQueue","original":{"line":18,"column":10},"generated":{"line":1,"column":201}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":23,"column":0},"generated":{"line":1,"column":204}},{"source":"src/SmpReact/main_methods/update.js","name":"flushRenderQueue","original":{"line":23,"column":9},"generated":{"line":1,"column":213}},{"source":"src/SmpReact/main_methods/update.js","name":"updateQueue","original":{"line":24,"column":6},"generated":{"line":1,"column":217}},{"source":"src/SmpReact/main_methods/update.js","name":"updateQueue","original":{"line":24,"column":6},"generated":{"line":1,"column":220}},{"source":"src/SmpReact/main_methods/update.js","name":"length","original":{"line":24,"column":18},"generated":{"line":1,"column":222}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":24,"column":26},"generated":{"line":1,"column":229}},{"source":"src/SmpReact/main_methods/update.js","name":"updateQueue","original":{"line":26,"column":4},"generated":{"line":1,"column":230}},{"source":"src/SmpReact/main_methods/update.js","name":"sort","original":{"line":26,"column":16},"generated":{"line":1,"column":232}},{"source":"src/SmpReact/main_methods/update.js","name":"curUpdater","original":{"line":30,"column":11},"generated":{"line":1,"column":239}},{"source":"src/SmpReact/main_methods/update.js","name":"curUpdater","original":{"line":29,"column":8},"generated":{"line":1,"column":243}},{"source":"src/SmpReact/main_methods/update.js","name":"curUpdater","original":{"line":29,"column":8},"generated":{"line":1,"column":247}},{"source":"src/SmpReact/main_methods/update.js","name":"updateQueue","original":{"line":29,"column":21},"generated":{"line":1,"column":249}},{"source":"src/SmpReact/main_methods/update.js","name":"pop","original":{"line":29,"column":33},"generated":{"line":1,"column":251}},{"source":"src/SmpReact/main_methods/update.js","name":"curUpdater","original":{"line":30,"column":11},"generated":{"line":1,"column":257}},{"source":"src/SmpReact/main_methods/update.js","name":"curUpdater","original":{"line":35,"column":10},"generated":{"line":1,"column":260}},{"source":"src/SmpReact/main_methods/update.js","name":"__dirty","original":{"line":35,"column":21},"generated":{"line":1,"column":262}},{"source":"src/SmpReact/main_methods/update.js","name":"curUpdater","original":{"line":37,"column":8},"generated":{"line":1,"column":272}},{"source":"src/SmpReact/main_methods/update.js","name":"__update","original":{"line":37,"column":19},"generated":{"line":1,"column":274}},{"source":"src/SmpReact/main_methods/update.js","name":"flushCallback","original":{"line":40,"column":8},"generated":{"line":1,"column":285}},{"source":"src/SmpReact/main_methods/update.js","name":"curUpdater","original":{"line":40,"column":22},"generated":{"line":1,"column":287}},{"source":"src/SmpReact/main_methods/update.js","name":"curUpdater","original":{"line":43,"column":6},"generated":{"line":1,"column":291}},{"source":"src/SmpReact/main_methods/update.js","name":"updateQueue","original":{"line":43,"column":19},"generated":{"line":1,"column":293}},{"source":"src/SmpReact/main_methods/update.js","name":"pop","original":{"line":43,"column":31},"generated":{"line":1,"column":295}},{"source":"src/SmpReact/main_methods/update.js","original":{"line":49,"column":0},"generated":{"line":1,"column":302}},{"source":"src/SmpReact/main_methods/update.js","name":"flushCallback","original":{"line":49,"column":9},"generated":{"line":1,"column":311}},{"source":"src/SmpReact/main_methods/update.js","name":"updater","original":{"line":49,"column":23},"generated":{"line":1,"column":313}},{"source":"src/SmpReact/main_methods/update.js","name":"callbacks","original":{"line":50,"column":8},"generated":{"line":1,"column":316}},{"source":"src/SmpReact/main_methods/update.js","name":"cbk","original":{"line":51,"column":6},"generated":{"line":1,"column":320}},{"source":"src/SmpReact/main_methods/update.js","name":"callbacks","original":{"line":50,"column":8},"generated":{"line":1,"column":322}},{"source":"src/SmpReact/main_methods/update.js","name":"updater","original":{"line":50,"column":20},"generated":{"line":1,"column":324}},{"source":"src/SmpReact/main_methods/update.js","name":"__setStateCallbacks","original":{"line":50,"column":28},"generated":{"line":1,"column":326}},{"source":"src/SmpReact/main_methods/update.js","name":"callbacks","original":{"line":52,"column":6},"generated":{"line":1,"column":346}},{"source":"src/SmpReact/main_methods/update.js","name":"callbacks","original":{"line":52,"column":6},"generated":{"line":1,"column":349}},{"source":"src/SmpReact/main_methods/update.js","name":"callbacks","original":{"line":52,"column":19},"generated":{"line":1,"column":352}},{"source":"src/SmpReact/main_methods/update.js","name":"length","original":{"line":52,"column":29},"generated":{"line":1,"column":354}},{"source":"src/SmpReact/main_methods/update.js","name":"cbk","original":{"line":53,"column":11},"generated":{"line":1,"column":361}},{"source":"src/SmpReact/main_methods/update.js","name":"cbk","original":{"line":53,"column":11},"generated":{"line":1,"column":366}},{"source":"src/SmpReact/main_methods/update.js","name":"callbacks","original":{"line":53,"column":17},"generated":{"line":1,"column":368}},{"source":"src/SmpReact/main_methods/update.js","name":"shift","original":{"line":53,"column":27},"generated":{"line":1,"column":370}},{"source":"src/SmpReact/main_methods/update.js","name":"cbk","original":{"line":53,"column":36},"generated":{"line":1,"column":379}},{"source":"src/SmpReact/main_methods/update.js","name":"call","original":{"line":53,"column":40},"generated":{"line":1,"column":381}},{"source":"src/SmpReact/main_methods/update.js","name":"updater","original":{"line":53,"column":45},"generated":{"line":1,"column":386}}],"sources":{"src/SmpReact/main_methods/update.js":"const defer = fn => {Promise.resolve().then(fn);}; //微任务 不阻塞宏任务（渲染等\r\n\r\nconst updateQueue = [];\r\n\r\n// 队列更新 API\r\nexport function enqueueRender(updater) {\r\n  // 将所有 updater 同步推入更新队列中\r\n  // 为实例添加一个属性 __dirty，标识是否处于待更新状态\r\n  // 初始 和 更新完毕，该值会被置为 false\r\n  // 推入队列时，标记为 true\r\n  if (\r\n    !updater.__dirty &&\r\n    (updater.__dirty = true) &&\r\n    updateQueue.push(updater) === 1\r\n  ) {\r\n    // 异步化冲洗队列\r\n    // 最终只执行一次冲洗\r\n    defer(flushRenderQueue);\r\n  }\r\n}\r\n\r\n// 合并一次循环中多次 updater\r\nfunction flushRenderQueue() {\r\n  if (updateQueue.length) {\r\n    // 排序更新队列\r\n    updateQueue.sort();\r\n\r\n    // 循环队列出栈\r\n    let curUpdater = updateQueue.pop();\r\n    while (curUpdater) {\r\n\r\n      // 当组件处于 待更新态 时，触发组件更新\r\n      // 如果该组件已经被更新完毕，则该状态为 false\r\n      // 则后续的更新均不再执行\r\n      if (curUpdater.__dirty) {\r\n        // 调用组件自身的更新函数\r\n        curUpdater.__update();\r\n\r\n        // 执行 callback\r\n        flushCallback(curUpdater);\r\n      }\r\n      // curUpdater.__dirty = false;\r\n      curUpdater = updateQueue.pop();\r\n    }\r\n  }\r\n}\r\n\r\n// 执行缓存在 updater.__setStateCallbacks 上的回调\r\nfunction flushCallback(updater) {\r\n  const callbacks = updater.__setStateCallbacks;\r\n  let cbk;\r\n  if (callbacks && callbacks.length) {\r\n    while (cbk = callbacks.shift()) cbk.call(updater);\r\n  }\r\n}"},"lineCount":null}},"error":null,"hash":"50c61d5ebb709a9c776a710d275e4704","cacheData":{"env":{}}}